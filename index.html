<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Wheel Spinner 1..5000 (No Duplicate Option)</title>
<style>
  :root{
    --bg:#0f1226; --card:#15193a; --text:#e8ecff; --muted:#aab1d6;
    --accent:#7c8cf8; --accent2:#37e0b2; --danger:#ff6b6b;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100svh; display:grid; place-items:center; padding:24px;
    font-family:system-ui,Segoe UI,Roboto,Arial; color:var(--text);
    background:
      radial-gradient(1200px 600px at 10% -10%, rgba(124,140,248,.20), transparent 60%),
      radial-gradient(1000px 500px at 120% 120%, rgba(55,224,178,.18), transparent 60%),
      var(--bg);
  }
  .app{width:min(1000px,100%);}
  .card{
    background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01)),var(--card);
    border:1px solid rgba(255,255,255,.08); border-radius:20px; padding:20px;
    box-shadow:0 10px 30px rgba(0,0,0,.35), 0 0 60px rgba(124,140,248,.15);
  }
  h1{margin:0 0 8px; font-size:clamp(20px,2.6vw,28px)}
  .sub{color:var(--muted); margin:0 0 14px; font-size:14px}
  .grid{display:grid; gap:16px; grid-template-columns: 1fr 1fr 1fr auto;}
  .field{display:flex; gap:8px; align-items:center; background:rgba(255,255,255,.03);
         border:1px solid rgba(255,255,255,.08); padding:12px; border-radius:12px;}
  .field label{font-size:14px; color:var(--muted)}
  input[type=number]{
    width:120px; background:#0e1130; color:var(--text); border:1px solid rgba(255,255,255,.12);
    border-radius:10px; padding:10px 12px; outline:none;
  }
  .chk{display:flex; align-items:center; gap:8px; padding:12px; border-radius:12px;
       background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08);}
  button{
    border:none; border-radius:12px; padding:12px 18px; font-weight:700; cursor:pointer;
    background:linear-gradient(180deg,var(--accent),#6373ff); color:#0e1130; margin-left:8px;
  }
  button.secondary{background:linear-gradient(180deg,#2b2f57,#1c2046); color:var(--text)}
  button.danger{background:linear-gradient(180deg,#ff8989,#ff6b6b); color:#2a0a0a}
  button:disabled{opacity:.6; cursor:not-allowed}

  .wrap{display:grid; grid-template-columns: 480px 1fr; gap:20px; align-items:center; margin-top:10px}
  @media (max-width:900px){ .wrap{grid-template-columns:1fr} }

  /* Wheel */
  .stage{display:grid; place-items:center}
  .arrow{
    width:0; height:0; border-left:18px solid transparent; border-right:18px solid transparent;
    border-bottom:28px solid var(--danger); margin-bottom:10px; filter:drop-shadow(0 2px 6px rgba(0,0,0,.6));
  }
  .wheel{
    width:min(440px, 90vw); height:min(440px, 90vw); border-radius:50%;
    border:10px solid #0b0e26; background:#0c0f2a; position:relative; overflow:hidden;
    box-shadow: inset 0 8px 30px rgba(0,0,0,.45), 0 8px 26px rgba(0,0,0,.35);
    transition: transform 3.8s cubic-bezier(.17,.67,.2,1.02);
  }
  .hub{
    position:absolute; inset:50% auto auto 50%; transform:translate(-50%,-50%);
    width:140px; height:140px; border-radius:50%; background:linear-gradient(180deg,#12163c,#0e1230);
    border:2px solid rgba(255,255,255,.08); display:grid; place-items:center; z-index:3;
    box-shadow:0 8px 18px rgba(0,0,0,.5);
  }
  .hub .num{
    font-size:clamp(36px,7vw,56px); font-weight:900; letter-spacing:.5px; font-variant-numeric:tabular-nums;
    text-shadow:0 6px 20px rgba(0,0,0,.45);
  }
  .seg{
    position:absolute; width:50%; height:50%; top:50%; left:50%; transform-origin:0 0; z-index:1;
    display:flex; align-items:center; justify-content:flex-end; padding-right:12px; font-weight:700;
    color:#0b0e26; text-shadow:0 1px 0 rgba(255,255,255,.25); font-size:14px;
  }
  .seg span{transform:skewY(calc(-1*(90deg - var(--a))));}
  .seg:nth-child(odd){background:#7c8cf8}
  .seg:nth-child(even){background:#37e0b2}

  .info{color:var(--muted); font-size:13px; display:flex; gap:10px; align-items:center; margin:6px 0 10px}
  .counter{padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.08); color:var(--text)}
  .warn{color:var(--danger)}
  .history{
    display:flex; gap:8px; flex-wrap:wrap; padding:10px; min-height:44px;
    background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.06); border-radius:14px;
  }
  .pill{
    padding:6px 10px; border-radius:999px; background:linear-gradient(180deg, rgba(124,140,248,.15), rgba(124,140,248,.08));
    border:1px solid rgba(124,140,248,.35); font-weight:600; color:var(--text); font-size:13px;
  }
</style>
</head>
<body>
  <div class="app">
    <div class="card">
      <h1>Wheel Spinner Angka</h1>
      <p class="sub">Putar roda, pilih angka acak dalam rentang <strong>Minimal…Maksimal</strong> (1–5000). Opsi <em>Tanpa duplikasi</em> akan mencegah angka terulang sampai semua habis.</p>

      <div class="grid">
        <div class="field">
          <label for="minInput">Minimal</label>
          <input id="minInput" type="number" inputmode="numeric" min="1" max="5000" value="1">
        </div>
        <div class="field">
          <label for="maxInput">Maksimal</label>
          <input id="maxInput" type="number" inputmode="numeric" min="1" max="5000" value="100">
        </div>
        <label class="chk">
          <input id="noRepeat" type="checkbox">
          <span>Tanpa duplikasi</span>
        </label>
        <div>
          <button id="spinBtn">Spin</button>
          <button id="resetBtn" class="danger">Reset</button>
        </div>
      </div>

      <div class="wrap">
        <div class="stage">
          <div class="arrow" aria-hidden="true"></div>
          <div id="wheel" class="wheel" aria-hidden="true"></div>
          <div class="hub" aria-live="polite" aria-atomic="true"><div id="centerNum" class="num">—</div></div>
        </div>

        <div>
          <div class="info">
            <span id="rangeText">Rentang: 1 … 100</span>
            <span id="remainWrap" class="counter" style="display:none;">Sisa unik: <strong id="remainCount">0</strong></span>
          </div>
          <div id="status" class="info">Siap diputar.</div>
          <div id="history" class="history" aria-label="Riwayat hasil"></div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ========= Helper =========
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));

  const minInput = $("#minInput");
  const maxInput = $("#maxInput");
  const noRepeat = $("#noRepeat");
  const spinBtn  = $("#spinBtn");
  const resetBtn = $("#resetBtn");
  const wheelEl  = $("#wheel");
  const centerNum= $("#centerNum");
  const statusEl = $("#status");
  const historyEl= $("#history");
  const rangeText= $("#rangeText");
  const remainWrap = $("#remainWrap");
  const remainCount= $("#remainCount");

  const MAX_LIMIT = 5000;
  const MIN_LIMIT = 1;

  let drawn = new Set();      // angka yang sudah keluar (saat noRepeat)
  let isSpinning = false;
  let currentRotation = 0;

  // ========= Wheel Segments (visual only) =========
  const SEGMENTS = 12; // segmen visual (tidak sama dengan jumlah angka)
  function buildWheel(){
    wheelEl.innerHTML = "";
    const a = 360 / SEGMENTS;
    for (let i=0;i<SEGMENTS;i++){
      const seg = document.createElement("div");
      seg.className = "seg";
      seg.style.setProperty("--a", a+"deg");
      seg.style.transform = `rotate(${i*a}deg) skewY(${90 - a}deg)`;
      const label = document.createElement("span");
      label.textContent = ""; // label kosong (hanya estetika roda)
      seg.appendChild(label);
      wheelEl.appendChild(seg);
    }
  }
  buildWheel();

  // ========= Range & Validation =========
  function clampInt(v, lo, hi){
    v = Math.floor(Number(v)||0);
    if (v < lo) v = lo;
    if (v > hi) v = hi;
    return v;
  }
  function normalizeRange(){
    let min = clampInt(minInput.value, MIN_LIMIT, MAX_LIMIT);
    let max = clampInt(maxInput.value, MIN_LIMIT, MAX_LIMIT);
    if (min > max) [min, max] = [max, min]; // tukar jika kebalik
    minInput.value = min;
    maxInput.value = max;
    rangeText.textContent = `Rentang: ${min} … ${max}`;

    // potong drawn agar tetap dalam rentang
    drawn.forEach(n => { if (n < min || n > max) drawn.delete(n); });
    updateRemain(min, max);
    return {min, max};
  }
  function updateRemain(min, max){
    if (!noRepeat.checked){
      remainWrap.style.display = "none";
      return;
    }
    const total = max - min + 1;
    const remain = Math.max(0, total - drawn.size);
    remainCount.textContent = remain;
    remainWrap.style.display = "inline-flex";
  }
  function setStatus(msg, warn=false){
    statusEl.textContent = msg;
    statusEl.classList.toggle("warn", !!warn);
  }

  // ========= Random Pick =========
  function randInt(min, max){
    return min + Math.floor(Math.random()*(max-min+1));
  }
  function pickNumber(min, max, unique){
    if (!unique) return randInt(min, max);
    const total = max - min + 1;
    if (drawn.size >= total) return null;
    // pilih angka yang belum pernah keluar
    // (range ≤ 5000 → aman membuat daftar)
    const avail = [];
    for (let n=min; n<=max; n++) if (!drawn.has(n)) avail.push(n);
    return avail[Math.floor(Math.random()*avail.length)];
  }

  // ========= Spin Logic =========
  function spin(){
    if (isSpinning) return;

    const {min, max} = normalizeRange();
    const unique = noRepeat.checked;

    // cek habis
    const total = max - min + 1;
    if (unique && drawn.size >= total){
      setStatus("Semua angka dalam rentang sudah terambil. Klik Reset untuk mulai ulang.", true);
      return;
    }

    const final = pickNumber(min, max, unique);
    if (final == null){
      setStatus("Tidak ada angka tersisa.", true);
      return;
    }

    // animasi roda (visual): putaran acak 4–7 kali + offset
    const fullTurns = 4 + Math.floor(Math.random()*3);
    const offsetDeg = Math.floor(Math.random()*360);
    currentRotation += fullTurns*360 + offsetDeg;

    isSpinning = true;
    spinBtn.disabled = true;
    minInput.disabled = true;
    maxInput.disabled = true;
    noRepeat.disabled = true;
    setStatus("Memutar roda…");

    // tampilkan angka setelah selesai animasi
    wheelEl.style.transform = `rotate(${currentRotation}deg)`;
    const DURATION = 3800; // ms, sinkron dengan CSS
    setTimeout(() => {
      centerNum.textContent = String(final);
      setStatus("Selesai!");

      if (unique) drawn.add(final);
      updateRemain(min, max);
      addHistory(final);

      isSpinning = false;
      spinBtn.disabled = false;
      minInput.disabled = false;
      maxInput.disabled = false;
      noRepeat.disabled = false;
    }, DURATION + 30);
  }

  function addHistory(n){
    const pill = document.createElement("div");
    pill.className = "pill";
    pill.textContent = n;
    historyEl.prepend(pill);
    const pills = $$(".history .pill");
    if (pills.length > 40) pills.slice(40).forEach(p => p.remove());
  }

  function resetAll(){
    drawn.clear();
    centerNum.textContent = "—";
    historyEl.innerHTML = "";
    setStatus("Di-reset. Siap diputar lagi.");
    normalizeRange();
  }

  // ========= Events =========
  spinBtn.addEventListener("click", spin);
  resetBtn.addEventListener("click", resetAll);

  minInput.addEventListener("input", () => { normalizeRange(); setStatus("Siap diputar."); });
  maxInput.addEventListener("input", () => { normalizeRange(); setStatus("Siap diputar."); });
  noRepeat.addEventListener("change", () => { normalizeRange(); setStatus(noRepeat.checked ? "Mode tanpa duplikasi aktif." : "Mode tanpa duplikasi nonaktif."); });

  // init
  normalizeRange();
</script>
</body>
</html>
